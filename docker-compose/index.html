<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <title>til / docker compose — Minghui Zhu</title>
    <meta property="og:url" content="https://minghui.space/til/docker-compose/">
    <meta property="og:title" content="til / docker compose — Minghui Zhu">
    <meta property="og:description" content="This past Black Friday (~4 days ago), I went on a shopping spree and bought… servers. Plain old servers. Being that most of my experience is Jamstack/serverless/Static Hosting, I thought it’d be interesting to self host some of the stuff myself.">
    <meta property="og:type" content="article">
    <meta property="article:author:first_name" content="Minghui">
    <meta property="article:author:last_name" content="Zhu">
    <meta property="article:published_time" content="2023-11-30T09:14:26.000-05:00">
    <meta property="article:modified_time" content="2023-11-30T14:18:13.000+00:00">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@MinghuiZhu4">
    <script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "LearningResource",
  "name": "docker compose",
  "description": "This past Black Friday (~4 days ago), I went on a shopping spree and bought… servers. Plain old servers. Being that most of my experience is Jamstack/serverless/Static Hosting, I thought it’d be interesting to self host some of the stuff myself.",
  "author": {
    "@type": "Person",
    "name": "Minghui Zhu",
    "url": "https://minghui.space"
  },
  "url": "https://minghui.space/til/docker-compose/",
  "datePublished": "2023-11-30T09:14:26.000-05:00",
  "dateModified": "2023-11-30T14:18:13.000+00:00",
  "keywords": "docker",
  "isPartOf": "https://minghui.space/til/",
  "license": "https://creativecommons.org/licenses/by/4.0/"
}
</script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://minghui.space/til/docker-compose/">
    <link rel="shortcut icon" href="../assets/favicon.png">
    <link rel="stylesheet" href="../assets/style.css">
    <link rel="alternate" type="application/atom+xml" title="Reader Feed" href="https://minghui.space/til/feed.xml">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61714711-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-61714711-1');
    </script>
  </head>
  <body>
    <header>
      <a href="https://minghui.space/til/"><img src="../assets/logo.svg" alt="Minghui Zhu"></a>
    </header>
    <article>
      <h1>
        <a href="../">til</a><span>docker compose</span>
      </h1>
      <p>
        This past Black Friday (~4 days ago), I went on a shopping spree and bought… servers. Plain old servers. Being that most of my experience is Jamstack/serverless/Static Hosting, I thought it’d be interesting to self host some of the stuff myself.
      </p>
      <p>
        While I am working on a Ruby on Rails project right now, I’ve been trying to make sure the stuff <em>around</em> the product are useful and present as well (monitoring, logs, etc.)
      </p>
      <p>
        So, I spent the past few hours playing with Uptime Kuma, and found a way to host multiple instances on the same IP address, all within a Docker Compose. Here’s the yaml. Hopefully someone finds this useful!
      </p>
      <pre data-code-block data-lang="yaml"><code><span data-line="1"><span style="color:#C2C3C5;"># https://github.com/SteveLTN/https-portal</span>
</span><span data-line="2"><span style="color:#C2C3C5;"># https://github.com/louislam/uptime-kuma/wiki/Reverse-Proxy</span>
</span><span data-line="3">
</span><span data-line="4"><span style="color:#D32F2F;">version</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;3.3&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span style="color:#D32F2F;">services</span><span style="color:#D32F2F;">:</span>
</span><span data-line="7"><span style="color:#24292EFF;">  </span><span style="color:#D32F2F;">https-portal</span><span style="color:#D32F2F;">:</span>
</span><span data-line="8"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">image</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">steveltn/https-portal:1</span>
</span><span data-line="9"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">ports</span><span style="color:#D32F2F;">:</span>
</span><span data-line="10"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">&quot;80:80&quot;</span>
</span><span data-line="11"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">&quot;443:443&quot;</span>
</span><span data-line="12"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">links</span><span style="color:#D32F2F;">:</span>
</span><span data-line="13"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">uptime-kuma-kevinjiang-ca</span>
</span><span data-line="14"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">uptime-kuma-k-j-ca</span>
</span><span data-line="15"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">restart</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">always</span>
</span><span data-line="16"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">environment</span><span style="color:#D32F2F;">:</span>
</span><span data-line="17"><span style="color:#24292EFF;">      </span><span style="color:#D32F2F;">DOMAINS</span><span style="color:#D32F2F;">:</span>
</span><span data-line="18"><span style="color:#24292EFF;">        </span><span style="color:#22863A;">&quot;status.kevinjiang.ca -&gt; http://uptime-kuma-kevinjiang-ca:3001,</span>
</span><span data-line="19"><span style="color:#22863A;">        status.k-j.ca -&gt; http://uptime-kuma-k-j-ca:3002&quot;</span>
</span><span data-line="20"><span style="color:#24292EFF;">      </span><span style="color:#C2C3C5;"># STAGE: 'production' # Don't use production until staging works</span>
</span><span data-line="21"><span style="color:#24292EFF;">      </span><span style="color:#D32F2F;">STAGE</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;production&quot;</span>
</span><span data-line="22"><span style="color:#24292EFF;">      </span><span style="color:#C2C3C5;"># FORCE_RENEW: 'true'</span>
</span><span data-line="23"><span style="color:#24292EFF;">      </span><span style="color:#D32F2F;">WEBSOCKET</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;true&quot;</span>
</span><span data-line="24"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">volumes</span><span style="color:#D32F2F;">:</span>
</span><span data-line="25"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">https-portal-data:/var/lib/https-portal</span>
</span><span data-line="26">
</span><span data-line="27"><span style="color:#24292EFF;">  </span><span style="color:#D32F2F;">uptime-kuma-kevinjiang-ca</span><span style="color:#D32F2F;">:</span>
</span><span data-line="28"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">image</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">louislam/uptime-kuma:1</span>
</span><span data-line="29"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">container_name</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">uptime-kuma-kevinjiang-ca</span>
</span><span data-line="30"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">volumes</span><span style="color:#D32F2F;">:</span>
</span><span data-line="31"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">./uptime-kuma-kevinjiang-ca:/app/data</span>
</span><span data-line="32"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">ports</span><span style="color:#D32F2F;">:</span>
</span><span data-line="33"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">3001:3001</span>
</span><span data-line="34">
</span><span data-line="35"><span style="color:#24292EFF;">  </span><span style="color:#D32F2F;">uptime-kuma-k-j-ca</span><span style="color:#D32F2F;">:</span>
</span><span data-line="36"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">image</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">louislam/uptime-kuma:1</span>
</span><span data-line="37"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">container_name</span><span style="color:#D32F2F;">:</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">uptime-kuma-k-j-ca</span>
</span><span data-line="38"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">volumes</span><span style="color:#D32F2F;">:</span>
</span><span data-line="39"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">./uptime-kuma-k-j-ca:/app/data</span>
</span><span data-line="40"><span style="color:#24292EFF;">    </span><span style="color:#D32F2F;">ports</span><span style="color:#D32F2F;">:</span>
</span><span data-line="41"><span style="color:#24292EFF;">      - </span><span style="color:#22863A;">3002:3001</span>
</span><span data-line="42">
</span><span data-line="43"><span style="color:#D32F2F;">volumes</span><span style="color:#D32F2F;">:</span>
</span><span data-line="44"><span style="color:#24292EFF;">  </span><span style="color:#D32F2F;">https-portal-data</span><span style="color:#D32F2F;">:</span>
</span></code></pre>
    </article>
    <footer>
      <div class="linkedlist">
        <a href="../dnssec3-hashing-and-cracking/" class="prev">DNSSEC3 Hashing, and Cracking</a><a href="../interesting-rails-conventions/" class="next">Interesting Rails Conventions</a>
      </div>
      <div class="license" xmlns:cc="http://creativecommons.org/ns" xmlns:dct="http://purl.org/dc/terms/">
        This <a property="dct:title" rel="cc:attributionURL" href="https://minghui.space/til/docker-compose/">til</a> was created <span property="dct:created" content="2023-11-30T09:14:26.000-05:00">Thu, Nov 30, 2023, 9:14 AM</span> ⸱ <a href="https://raw.githubusercontent.com/zhuminghui17/til/main/entries/docker%20compose.md" target="_blank">raw</a> ⸱ <a href="https://github.com/zhuminghui17/til/edit/main/entries/docker%20compose.md#L8" target="_blank">edit</a><br>© <span rel="dct:dateCopyrighted">2023</span> <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://minghui.space">Minghui Zhu</a> ⸱ licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank" rel="cc:license license noopener noreferrer">CC BY 4.0<img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" aria-hidden="true"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" aria-hidden="true"></a> ⸱ <a href="https://minghui.space/til/feed.xml" rel="alternate feed" type="application/atom+xml">feed</a>
      </div>
    </footer>
  </body>
</html>